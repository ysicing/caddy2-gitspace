{
	admin localhost:2019

	# 阿里云 DNS API 配置
	acme_dns alidns {
		access_key_id {$ALICLOUD_ACCESS_KEY}
		access_key_secret {$ALICLOUD_SECRET_KEY}
	}
}

# HTTPS 通配符域名
*.{$BASE_DOMAIN:example.com} {
	tls {
		dns alidns {
			access_key_id {$ALICLOUD_ACCESS_KEY}
			access_key_secret {$ALICLOUD_SECRET_KEY}
		}
	}

	k8s_router {
		namespace {$K8S_NAMESPACE:default}
		base_domain {$BASE_DOMAIN:example.com}
		default_port {$DEFAULT_PORT:8089}
		# 可选: 通过 label selector 筛选需要管理的 Deployment
		# label_selector "app.kubernetes.io/managed-by=caddy"
		# label_selector "env=production,team=backend"
	}

	handle /healthz {
		respond "OK" 200
	}
}
